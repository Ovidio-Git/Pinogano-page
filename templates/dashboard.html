{% extends 'layout.html' %}
{% block body %}


<div class="container-fluid pt-4 cab">
    <div class="row">
      <div class="col-md-12 pt-4 pb-4">
        <h3 class="text-center cl"><strong>TESTING Monitoreo energético</strong></h3>
      </div>
      <div class="statistics col-md-4">
        <div class="card text-white bg-ligth mb-3">
          <div class="card-body shadow">
            <h5 class="card-title text-secondary">Valor pico diario</h5>
            <div  class="dfont">{{ max_value }} W </div>
            <canvas id="tortaPorcentaje" width="40" height="70"></canvas>
          </div>
        </div>
      </div>
      <div class="statistics col-md-4">
        <div class="card text-white  mb-3">
          <div class="card-body shadow" >
            <h5 class="card-title text-secondary">Consumo (Wh)</h5>
            <div class="position-absolute text-center dfont">{{ average_wh }} Wh </div>
            <canvas id="tortaPorcentaje" width="40" height="70"></canvas>
          </div>
        </div>
      </div>
      <div class="statistics col-md-4">
        <div class="card text-white mb-3">
          <div class="card-body shadow" >
            <h5 class="card-title text-secondary">Valor consumo energetico</h5>
            <div class=" position-absolute text-center money">$ {{ price_wh }}  </div>
            <canvas id="tortaPorcentaje" width="40" height="70"></canvas>
          </div>
        </div>
      </div>
      <div class="col-md-6 ">
        <div class="card mb-3">
          <div class="card-body shadow">
            <h5 class="card-title text-secondary">Consumo (W) </h5>
            <div class="position-absolute hauge posi">{{ data }} </div>
            <canvas id="donut" width="500" height="400"></canvas>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card mb-3">
          <div class="card-body shadow">
            <h5 class="card-title text-secondary">Histórico Del Dia</h5>
            <canvas id="tableline" width="500" height="400"></canvas>
          </div>
        </div>
      </div>
    </div>
</div>


<!--suppress JSUnresolvedLibraryURL -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>


<!--suppress JSUnresolvedLibraryURL -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
<!--suppress JSUnresolvedLibraryURL -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>

<!-- LINE GRAPH-->
<script>
    Chart.defaults.global.responsive = true;
    Chart.defaults.global.legend.display = false;

      
 
    function update_values(){
            $.getJSON($SCRIPT_ROOT + '/data_sensor');
            config.data.labels.push(data.fecha);
            config.data.datasets[0].data.push(data.value1);
            lineChart.update();
        
        };
      
    var context = document.getElementById('tableline').getContext('2d');
        var config = new Chart(context,{
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: "Potencia",
                    backgroundColor: "rgb(132,186,91,0.2)",
                    borderColor: "rgb(62,150,81,1)",
                    data: [],
                    fill: false,
                }],
            },
            options: {
                responsive: true,
                title: {
                    display: true,
                },
                tooltips: {
                    mode: 'index',
                    intersect: false,
                },
                hover: {
                    mode: 'nearest',
                    intersect: true
                },
                scales: {
                    xAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Tiempo'
                        }
                    }],
                    yAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Potencia'
                        }
                    }]
                }
            }
        );

</script>


  <!-- DOUGHNUT GRAPH  -->
  <script>
    Chart.defaults.global.responsive = true;
    Chart.defaults.global.legend.display = false;

    var data1 = {
      labels: ['Consumo', 'Sin consumir'],
      datasets: [{
          backgroundColor: ["rgba(48, 207, 149, 1)",
                            "rgba(114,147,203,0.2)"],
          data : [ {{ data }} , {{ 3500 - data}} ],
      }]
    };

    var ctx = document.getElementById("donut").getContext("2d");
    var co = new Chart(ctx, {
      type: 'doughnut',
      data: data1,
      options: {
          cutoutPercentage:73,
          circumference:Math.PI,
          rotation:Math.PI,
          responsive: true,
      }
    });
  </script>


{% endblock %}

